<div class="container mt-5" *ngIf="cart$ | async as cart; else loading">
  <h2 class="mb-4 text-center">🛒 Tu carrito</h2>

  <div *ngIf="cart.items.length > 0; else emptyCart">
    <c-card class="mb-3" *ngFor="let item of cart.items">
      <div class="card-body d-flex justify-content-between align-items-center">
        <div>
          <h5>{{ item.productName }}</h5>
          <p>Cantidad: {{ item.quantity }}</p>
        </div>
        <strong>Subtotal: Q{{ item.subtotal }}</strong>
      </div>
    </c-card>

    <div class="text-end">
      <h4>Total: Q{{ cart.total }}</h4>
      <button cButton color="danger" (click)="clearCart()">Vaciar carrito</button>
    </div>
  </div>

  <!-- Botón generar orden -->
  <div class="text-end">
    <button cButton color="success" (click)="generateOrder('Dirección de entrega')">
      Generar Orden
    </button>
  </div>
  <ng-template #emptyCart>
    <p class="text-muted text-center">Tu carrito está vacío</p>
  </ng-template>

  <ng-template #emptyCart>
    <p class="text-muted text-center">Tu carrito está vacío</p>
  </ng-template>
</div>

<ng-template #loading>
  <div class="text-center mt-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-3 text-muted">Cargando carrito...</p>
  </div>
</ng-template>